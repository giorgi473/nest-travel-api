# [build]
# command = "npm run build"
# functions = "netlify/functions"
# publish = "dist"

# [functions]
# node_bundler = "esbuild"
# external_node_modules = [
#     "express",
#     "@nestjs/core",
#     "@nestjs/common",
#     "@nestjs/platform-express",
#     "typeorm",
# ]

# # ✅ CORS Headers
# [[headers]]
# for = "/*"
# [headers.values]
# Access-Control-Allow-Origin = "*"
# Access-Control-Allow-Methods = "GET, POST, PUT, DELETE, PATCH, OPTIONS"
# Access-Control-Allow-Headers = "Content-Type, Authorization"
# Access-Control-Allow-Credentials = "true"

# [[redirects]]
# from = "/*"
# to = "/.netlify/functions/api"
# status = 200
# force = true
[build]
command = "npm run build"
functions = "netlify/functions"
publish = "dist"

[functions]
# ვენდობით esbuild-ს, რომ ის ჩააბანდლებს მხოლოდ იმას, რაც კოდს სჭირდება.
node_bundler = "esbuild"

# 🔴 ეს სექცია ამოღებულია, რადგან ის აიძულებდა Netlify-ს
# ჩაერთო მთელი 250MB+ ზომის node_modules საქაღალდე:
# included_files = ["node_modules/**"]

# CORS Headers (უცვლელი, რადგან სწორია)
[[headers]]
for = "/*"
[headers.values]
Access-Control-Allow-Origin = "*"
Access-Control-Allow-Methods = "GET, POST, PUT, DELETE, PATCH, OPTIONS"
Access-Control-Allow-Headers = "Content-Type, Authorization"
Access-Control-Allow-Credentials = "true"

# Redirects (უცვლელი, რადგან სწორია)
[[redirects]]
from = "/*"
to = "/.netlify/functions/api"
status = 200
force = true
